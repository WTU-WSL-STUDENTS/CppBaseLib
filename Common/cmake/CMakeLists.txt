cmake_minimum_required(VERSION 3.0.0)
project(CppCommon VERSION 0.1.0)
set(CMAKE_CXX_STANDARD 17)
if (POLICY CMP0025)
  cmake_policy(SET CMP0025 NEW)
endif()
if (POLICY CMP0054)
  cmake_policy(SET CMP0054 NEW)
endif()
# 0. 预定义
set(RELEASE_PATH ../Build/bin)
set(Lib_Path ../Build/lib)
if     (CMAKE_SYSTEM_NAME MATCHES "Linux")
    add_definitions(-D__LINUX)
elseif (CMAKE_SYSTEM_NAME MATCHES "Windows")
    add_definitions(-D__WINDOWS)
elseif (CMAKE_SYSTEM_NAME MATCHES "FreeBSD")
    add_definitions(-D__FREE_BSD)
else ()
    message(STATUS "other platform: ${CMAKE_SYSTEM_NAME}")
endif (CMAKE_SYSTEM_NAME MATCHES "Linux")
## 判断编译器
if     ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "Clang")
elseif ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "GNU")
elseif ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "Intel")
elseif ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "MSVC")
    if(CMAKE_CL_64)
        add_definitions(-D__MSVC_64) 
        set(RELEASE_PATH ../Build/bin/x64)
        set(Lib_Path ../Build/lib/x64)
    else()
        add_definitions(-D_WIN32)
        add_definitions(-D__MSVC_32)
        set(RELEASE_PATH ../Build/bin/x86)
        set(Lib_Path ../Build/lib/x86)
    endif()
endif()

# 1. 设置编译变量
set(INCLUDE_PATH ../include)
set(SRC_PATH ../src)
set(THIRD_PARTY_PATH ../thirdparty)
set(UNITS_TEST_PATH ../unittests)
# 2. 设置输出路径
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_DEBUG 	${RELEASE_PATH})
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELEASE 	${RELEASE_PATH})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_DEBUG 	${Lib_Path})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RLEASE 	${Lib_Path})
# 3. 添加文件目录
include_directories(${INCLUDE_PATH})
include_directories(${SRC_PATH})
# 4. 添加Common源码
file(GLOB CommonSrc ${SRC_PATH}/*.hpp ${SRC_PATH}/*.cpp)
# 5. 编译单元测试
include(CommonUnitTests.cmake)


